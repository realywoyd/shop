<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="sandbox allow-same-origin allow-modals allow-scripts">
    <title>Dark Thailand - –ù–∞–¥—ë–∂–Ω—ã–π —à–æ–ø</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1a1a1a 0%, #2b0000 100%);
            color: #ff4444;
            overflow-x: hidden;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
        }
        .header {
            text-align: center;
            padding: 15px 0;
            background-color: #2b2b2b;
            color: #ff4444;
            margin-bottom: 20px;
            border-radius: 5px;
            border: 2px solid #ff4444;
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.5);
            position: relative;
        }
        .logo {
            font-size: 48px;
            animation: skullPulse 2s infinite;
            display: inline-block;
        }
        @keyframes skullPulse {
            0% { transform: scale(1); text-shadow: 0 0 5px #ff4444; }
            50% { transform: scale(1.1); text-shadow: 0 0 20px #ff4444, 0 0 30px #ff6666; }
            100% { transform: scale(1); text-shadow: 0 0 5px #ff4444; }
        }
        .header-text {
            font-size: 16px;
            margin-top: 5px;
            animation: textFlicker 3s infinite;
        }
        @keyframes textFlicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .nav {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .nav-button {
            background-color: #ff4444;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            animation: neonPulse 1.5s infinite;
        }
        .profile-button {
            background-color: #ff4444;
            color: #000;
            border: none;
            padding: 0;
            border-radius: 5px;
            cursor: pointer;
            font-size: 26px;
            width: 60px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            animation: neonPulse 1.5s infinite;
        }
        @keyframes neonPulse {
            0% { box-shadow: 0 0 5px #ff4444; }
            50% { box-shadow: 0 0 20px #ff4444; }
            100% { box-shadow: 0 0 5px #ff4444; }
        }
        .catalog-menu, .profile-menu, .vacancy-menu, .mail-menu {
            display: none;
            background-color: #333;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 0 15px rgba(255, 68, 68, 0.3);
        }
        .city-filter {
            margin-bottom: 15px;
        }
        .city-filter select, .district-filter select {
            width: 100%;
            padding: 10px;
            background-color: #2b2b2b;
            color: #ff4444;
            border: 1px solid #ff4444;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 10px;
        }
        .tabs {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        .tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            background-color: #2b2b2b;
            cursor: pointer;
            margin: 5px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        .tab:hover {
            background-color: #ff6666;
        }
        .tab.active {
            background-color: #ff4444;
            color: #000;
            box-shadow: 0 0 10px #ff4444;
        }
        .tab-content {
            display: none;
        }
        .product-card {
            background-color: #333;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(255, 68, 68, 0.3);
            transition: transform 0.2s;
        }
        .product-card:hover {
            transform: scale(1.02);
        }
        .product-card h3 {
            margin-top: 0;
            color: #ff6666;
            cursor: pointer;
        }
        .product-card p {
            margin: 5px 0;
        }
        .price {
            font-weight: bold;
            color: #ff9999;
        }
        .crypto-price {
            font-size: 12px;
            color: #ff6666;
        }
        .buy-button, .preorder-button {
            background-color: #ff4444;
            color: #000;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px 0;
            width: 100%;
            transition: all 0.3s;
        }
        .preorder-button {
            background-color: #ff6666;
        }
        .buy-button:hover, .preorder-button:hover {
            background-color: #ff8888;
        }
        .payment-modal, .product-modal, .deposit-modal, .preorder-modal, .registration-modal, .custom-modal, .confirm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }
        .payment-content, .product-content, .deposit-content, .preorder-content, .registration-content, .custom-content, .confirm-content {
            background: #333;
            padding: 20px;
            border-radius: 5px;
            text-align: center;
            color: #ff4444;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .review {
            background-color: #2b2b2b;
            border-left: 4px solid #ff6666;
            padding: 10px;
            margin: 10px 0;
            font-size: 12px;
            color: #ff9999;
            text-align: left;
        }
        .moderator-response {
            background-color: #2b2b2b;
            border-left: 4px solid #ff4444;
            padding: 10px;
            margin: 5px 0 10px 20px;
            font-size: 12px;
            color: #ff6666;
            text-align: left;
        }
        .position {
            margin: 10px 0;
            text-align: left;
        }
        .promo-banner {
            background-color: #ff4444;
            color: #000;
            padding: 10px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 5px;
            font-weight: bold;
        }
        .vacancy {
            margin-bottom: 15px;
        }
        .vacancy h3 {
            color: #ff6666;
        }
        input[type="text"], textarea, input[type="number"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background-color: #2b2b2b;
            color: #ff4444;
            border: 1px solid #ff4444;
            border-radius: 5px;
        }
        textarea {
            height: 100px;
            resize: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="promo-banner">
            <p>–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–Ω—É—Å—ã! 5 –¥—Ä—É–∑–µ–π = 0.5 –≥ –∞–º—Ñ–µ—Ç–∞–º–∏–Ω–∞, 10 –¥—Ä—É–∑–µ–π = 0.5 –≥ –∫–æ–∫–∞–∏–Ω–∞ (MQ), 25 –¥—Ä—É–∑–µ–π = 1 –≥ –∫–æ–∫–∞–∏–Ω–∞ (VHQ)!</p>
        </div>

        <div class="header">
            <div class="logo">üíÄ</div>
            <div class="header-text">Dark Thailand - –¢–≤–æ–π —Ç–µ–Ω–µ–≤–æ–π –≥–∏–¥ –ø–æ –¢–∞–∏–ª–∞–Ω–¥—É</div>
        </div>
        
        <div class="nav">
            <button class="nav-button" onclick="toggleCatalog()">–ö–∞—Ç–∞–ª–æ–≥</button>
            <button class="nav-button" onclick="toggleVacancies()">–í–∞–∫–∞–Ω—Å–∏–∏</button>
            <button class="nav-button" onclick="toggleMail()">–ü–æ—á—Ç–∞</button>
            <button class="profile-button" onclick="toggleProfile()">üíÄ</button>
        </div>
        
        <div class="catalog-menu" id="catalogMenu">
            <div class="city-filter">
                <select id="citySelect" onchange="filterByCity()">
                    <option value="all">–í—Å–µ –≥–æ—Ä–æ–¥–∞</option>
                    <option value="phuket">–ü—Ö—É–∫–µ—Ç</option>
                    <option value="pattaya">–ü–∞—Ç—Ç–∞–π—è</option>
                    <option value="bangkok">–ë–∞–Ω–≥–∫–æ–∫</option>
                    <option value="samui">–æ. –°–∞–º—É–∏</option>
                </select>
                <select id="districtSelect" onchange="filterByDistrict()">
                    <option value="all">–í—Å–µ —Ä–∞–π–æ–Ω—ã</option>
                </select>
            </div>
            <div class="tabs">
                <div class="tab" data-tab="weed">–ú–∞—Ä–∏—Ö—É–∞–Ω–∞</div>
                <div class="tab" data-tab="hash">–ì–∞—à–∏—à</div>
                <div class="tab" data-tab="coke">–ö–æ–∫–∞–∏–Ω</div>
                <div class="tab" data-tab="amph">–ê–º—Ñ–µ—Ç–∞–º–∏–Ω</div>
                <div class="tab" data-tab="meth">–ú–µ—Ç–∞–º—Ñ–µ—Ç–∞–º–∏–Ω</div>
                <div class="tab" data-tab="meph">–ú–µ—Ñ–µ–¥—Ä–æ–Ω</div>
                <div class="tab" data-tab="alpha">Alpha-PVP</div>
                <div class="tab" data-tab="lsd">LSD</div>
                <div class="tab" data-tab="mdma">MDMA</div>
                <div class="tab" data-tab="heroin">–ì–µ—Ä–æ–∏–Ω</div>
            </div>

            <div id="weed" class="tab-content">
                <div class="product-card" data-product="weed-1">
                    <h3 onclick="showProductModal('weed', 1)">Jamaican Haze (VHQ)</h3>
                    <p>–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è —è–º–∞–π—Å–∫–∞—è —Å–∞—Ç–∏–≤–∞, —á–∏—Å—Ç–µ–π—à–∏–π –∫–∞–π—Ñ</p>
                </div>
            </div>

            <div id="hash" class="tab-content">
                <div class="product-card" data-product="hash-1">
                    <h3 onclick="showProductModal('hash', 1)">Afghan Black Gold (VHQ)</h3>
                    <p>–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π –∞—Ñ–≥–∞–Ω—Å–∫–∏–π –≥–∞—à–∏—à, –±–∞—Ä—Ö–∞—Ç–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç</p>
                </div>
                <div class="product-card" data-product="hash-2">
                    <h3 onclick="showProductModal('hash', 2)">Moroccan Spice (HQ)</h3>
                    <p>–ú–∞—Ä–æ–∫–∫–∞–Ω—Å–∫–∏–π –≥–∞—à–∏—à —Å –ø—Ä—è–Ω—ã–º –∞—Ä–æ–º–∞—Ç–æ–º</p>
                </div>
                <div class="product-card" data-product="hash-3">
                    <h3 onclick="showProductModal('hash', 3)">Nepal Temple (MQ)</h3>
                    <p>–ù–µ–ø–∞–ª—å—Å–∫–∏–π –≥–∞—à–∏—à, —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–æ—É–Ω</p>
                </div>
                <div class="product-card" data-product="hash-4">
                    <h3 onclick="showProductModal('hash', 4)">Local Dust (LQ)</h3>
                    <p>–ú–µ—Å—Ç–Ω—ã–π –±—é–¥–∂–µ—Ç–Ω—ã–π –≥–∞—à–∏—à</p>
                </div>
                <div class="product-card" data-product="hash-5">
                    <h3 onclick="showProductModal('hash', 5)">Himalayan Storm (VHQ)</h3>
                    <p>–ì–∏–º–∞–ª–∞–π—Å–∫–∏–π —à—Ç–æ—Ä–º, –º–æ—â–Ω—ã–π –∏ —á–∏—Å—Ç—ã–π</p>
                </div>
            </div>

            <div id="coke" class="tab-content">
                <div class="product-card" data-product="coke-1">
                    <h3 onclick="showProductModal('coke', 1)">Bolivian Fishscale (VHQ)</h3>
                    <p>–ë–æ–ª–∏–≤–∏–π—Å–∫–∏–π –∫–æ–∫–∞–∏–Ω –≤—ã—Å—à–µ–π –ø—Ä–æ–±—ã, 95%+</p>
                </div>
                <div class="product-card" data-product="coke-2">
                    <h3 onclick="showProductModal('coke', 2)">Colombian Snow (HQ)</h3>
                    <p>–ö–æ–ª—É–º–±–∏–π—Å–∫–∏–π —Å–Ω–µ–≥, —á–∏—Å—Ç—ã–π –∏ –º–æ—â–Ω—ã–π</p>
                </div>
                <div class="product-card" data-product="coke-3">
                    <h3 onclick="showProductModal('coke', 3)">Peruvian Dust (MQ)</h3>
                    <p>–ü–µ—Ä—É–∞–Ω—Å–∫–∞—è –ø—ã–ª—å, —Å—Ä–µ–¥–Ω–∏–π –∫–∞–π—Ñ</p>
                </div>
                <div class="product-card" data-product="coke-4">
                    <h3 onclick="showProductModal('coke', 4)">Street Mix (LQ)</h3>
                    <p>–£–ª–∏—á–Ω—ã–π –º–∏–∫—Å, –±—é–¥–∂–µ—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</p>
                </div>
                <div class="product-card" data-product="coke-5">
                    <h3 onclick="showProductModal('coke', 5)">Cartel Gold (VHQ)</h3>
                    <p>–ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∫–∞—Ä—Ç–µ–ª—è, —ç–ª–∏—Ç–∞</p>
                </div>
            </div>

            <div id="amph" class="tab-content">
                <div class="product-card" data-product="amph-1">
                    <h3 onclick="showProductModal('amph', 1)">Crystal Surge (VHQ)</h3>
                    <p>–ö—Ä–∏—Å—Ç–∞–ª—å–Ω—ã–π –∞–º—Ñ–µ—Ç–∞–º–∏–Ω, —á–∏—Å—Ç–µ–π—à–∞—è —ç–Ω–µ—Ä–≥–∏—è</p>
                </div>
                <div class="product-card" data-product="amph-2">
                    <h3 onclick="showProductModal('amph', 2)">Red Rush (HQ)</h3>
                    <p>–ö—Ä–∞—Å–Ω—ã–π –∑–∞—Ä—è–¥, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥—Ä–∞–π–≤</p>
                </div>
                <div class="product-card" data-product="amph-3">
                    <h3 onclick="showProductModal('amph', 3)">Yellow Spark (MQ)</h3>
                    <p>–ñ—ë–ª—Ç–∞—è –∏—Å–∫—Ä–∞, —Å—Ä–µ–¥–Ω–∏–π –ø–æ–¥—ä—ë–º</p>
                </div>
                <div class="product-card" data-product="amph-4">
                    <h3 onclick="showProductModal('amph', 4)">Grey Haze (LQ)</h3>
                    <p>–°–µ—Ä—ã–π —Ç—É–º–∞–Ω, –±–∞–∑–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</p>
                </div>
                <div class="product-card" data-product="amph-5">
                    <h3 onclick="showProductModal('amph', 5)">Blue Blitz (VHQ)</h3>
                    <p>–°–∏–Ω–∏–π —É–¥–∞—Ä, —ç–ª–∏—Ç–Ω—ã–π –∞–º—Ñ</p>
                </div>
            </div>

            <div id="meth" class="tab-content">
                <div class="product-card" data-product="meth-1">
                    <h3 onclick="showProductModal('meth', 1)">Mountain Ice (VHQ)</h3>
                    <p>–ì–æ—Ä–Ω—ã–π –ª—ë–¥, –∫—Ä–∏—Å—Ç–∞–ª—å–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞</p>
                </div>
                <div class="product-card" data-product="meth-2">
                    <h3 onclick="showProductModal('meth', 2)">Blue Flame (HQ)</h3>
                    <p>–°–∏–Ω–µ–µ –ø–ª–∞–º—è, –¥–æ–ª–≥–∏–π —ç—Ñ—Ñ–µ–∫—Ç</p>
                </div>
                <div class="product-card" data-product="meth-3">
                    <h3 onclick="showProductModal('meth', 3)">White Shard (MQ)</h3>
                    <p>–ë–µ–ª—ã–π –æ—Å–∫–æ–ª–æ–∫, —Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</p>
                </div>
                <div class="product-card" data-product="meth-4">
                    <h3 onclick="showProductModal('meth', 4)">Dirty Crystal (LQ)</h3>
                    <p>–ì—Ä—è–∑–Ω—ã–π –∫—Ä–∏—Å—Ç–∞–ª–ª, —ç–∫–æ–Ω–æ–º-–∫–ª–∞—Å—Å</p>
                </div>
                <div class="product-card" data-product="meth-5">
                    <h3 onclick="showProductModal('meth', 5)">Golden Shard (VHQ)</h3>
                    <p>–ó–æ–ª–æ—Ç–æ–π –æ—Å–∫–æ–ª–æ–∫, —Ç–æ–ø–æ–≤—ã–π –º–µ—Ç</p>
                </div>
            </div>

            <div id="meph" class="tab-content">
                <div class="product-card" data-product="meph-1">
                    <h3 onclick="showProductModal('meph', 1)">Pink Bliss (VHQ)</h3>
                    <p>–†–æ–∑–æ–≤–æ–µ –±–ª–∞–∂–µ–Ω—Å—Ç–≤–æ, —á–∏—Å—Ç–µ–π—à–∏–π –∫–∞–π—Ñ</p>
                </div>
                <div class="product-card" data-product="meph-2">
                    <h3 onclick="showProductModal('meph', 2)">White Surge (HQ)</h3>
                    <p>–ë–µ–ª—ã–π –≤—Å–ø–ª–µ—Å–∫, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç</p>
                </div>
                <div class="product-card" data-product="meph-3">
                    <h3 onclick="showProductModal('meph', 3)">Grey Mist (MQ)</h3>
                    <p>–°–µ—Ä—ã–π —Ç—É–º–∞–Ω, —Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</p>
                </div>
                <div class="product-card" data-product="meph-4">
                    <h3 onclick="showProductModal('meph', 4)">Dusty High (LQ)</h3>
                    <p>–ü—ã–ª—å–Ω—ã–π –∫–∞–π—Ñ, –±—é–¥–∂–µ—Ç–Ω—ã–π –º–µ—Ñ</p>
                </div>
                <div class="product-card" data-product="meph-5">
                    <h3 onclick="showProductModal('meph', 5)">Red Pulse (VHQ)</h3>
                    <p>–ö—Ä–∞—Å–Ω—ã–π –ø—É–ª—å—Å, —ç–ª–∏—Ç–Ω—ã–π –ø—Ä–∏—Ö–æ–¥</p>
                </div>
            </div>

            <div id="alpha" class="tab-content">
                <div class="product-card" data-product="alpha-1">
                    <h3 onclick="showProductModal('alpha', 1)">Flakka Fire (VHQ)</h3>
                    <p>–û–≥–Ω–µ–Ω–Ω–∞—è —Ñ–ª–∞–∫–∫–∞, —á–∏—Å—Ç–µ–π—à–∏–π Alpha-PVP</p>
                </div>
                <div class="product-card" data-product="alpha-2">
                    <h3 onclick="showProductModal('alpha', 2)">Purple Haze (HQ)</h3>
                    <p>–ü—É—Ä–ø—É—Ä–Ω—ã–π —Ç—É–º–∞–Ω, –º–æ—â–Ω—ã–π –∑–∞—Ä—è–¥</p>
                </div>
                <div class="product-card" data-product="alpha-3">
                    <h3 onclick="showProductModal('alpha', 3)">Green Dust (MQ)</h3>
                    <p>–ó–µ–ª—ë–Ω–∞—è –ø—ã–ª—å, —Å—Ä–µ–¥–Ω–∏–π —ç—Ñ—Ñ–µ–∫—Ç</p>
                </div>
                <div class="product-card" data-product="alpha-4">
                    <h3 onclick="showProductModal('alpha', 4)">Street Gravel (LQ)</h3>
                    <p>–£–ª–∏—á–Ω—ã–π –≥—Ä–∞–≤–∏–π, –±—é–¥–∂–µ—Ç–Ω—ã–π Alpha</p>
                </div>
                <div class="product-card" data-product="alpha-5">
                    <h3 onclick="showProductModal('alpha', 5)">Crystal Fury (VHQ)</h3>
                    <p>–ö—Ä–∏—Å—Ç–∞–ª—å–Ω–∞—è —è—Ä–æ—Å—Ç—å, —Ç–æ–ø–æ–≤—ã–π PVP</p>
                </div>
            </div>

            <div id="lsd" class="tab-content">
                <div class="product-card" data-product="lsd-1">
                    <h3 onclick="showProductModal('lsd', 1)">Cosmic Tabs (VHQ)</h3>
                    <p>–ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä–∫–∏, —á–∏—Å—Ç–µ–π—à–∏–π —Ç—Ä–∏–ø</p>
                </div>
                <div class="product-card" data-product="lsd-2">
                    <h3 onclick="showProductModal('lsd', 2)">Neon Drops (HQ)</h3>
                    <p>–ù–µ–æ–Ω–æ–≤—ã–µ –∫–∞–ø–ª–∏, —è—Ä–∫–∏–π –æ–ø—ã—Ç</p>
                </div>
                <div class="product-card" data-product="lsd-3">
                    <h3 onclick="showProductModal('lsd', 3)">Acid Rain (MQ)</h3>
                    <p>–ö–∏—Å–ª–æ—Ç–Ω—ã–π –¥–æ–∂–¥—å, —Å—Ä–µ–¥–Ω–∏–π —Ç—Ä–∏–ø</p>
                </div>
                <div class="product-card" data-product="lsd-4">
                    <h3 onclick="showProductModal('lsd', 4)">Street Blotters (LQ)</h3>
                    <p>–£–ª–∏—á–Ω—ã–µ –±–ª–æ—Ç—Ç–µ—Ä—ã, –±–∞–∑–æ–≤—ã–π LSD</p>
                </div>
                <div class="product-card" data-product="lsd-5">
                    <h3 onclick="showProductModal('lsd', 5)">Galactic Hits (VHQ)</h3>
                    <p>–ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∏—Ç—ã, —ç–ª–∏—Ç–Ω—ã–π –∫–∏—Å–ª—ã–π</p>
                </div>
            </div>

            <div id="mdma" class="tab-content">
                <div class="product-card" data-product="mdma-1">
                    <h3 onclick="showProductModal('mdma', 1)">Crystal Love (VHQ)</h3>
                    <p>–ö—Ä–∏—Å—Ç–∞–ª—å–Ω–∞—è –ª—é–±–æ–≤—å, —á–∏—Å—Ç–µ–π—à–∏–π MDMA</p>
                </div>
                <div class="product-card" data-product="mdma-2">
                    <h3 onclick="showProductModal('mdma', 2)">Pink Rocks (HQ)</h3>
                    <p>–†–æ–∑–æ–≤—ã–µ –∫–∞–º–Ω–∏, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–∞–π—Ñ</p>
                </div>
                <div class="product-card" data-product="mdma-3">
                    <h3 onclick="showProductModal('mdma', 3)">Ecstasy Blue (VHQ Tabs)</h3>
                    <p>–°–∏–Ω–∏–π —ç–∫—Å—Ç–∞–∑–∏, —Ç–æ–ø–æ–≤—ã–µ —Ç–∞–±–ª–µ—Ç–∫–∏</p>
                </div>
                <div class="product-card" data-product="mdma-4">
                    <h3 onclick="showProductModal('mdma', 4)">Molly Dust (MQ)</h3>
                    <p>–ü—ã–ª—å –ú–æ–ª–ª–∏, —Å—Ä–µ–¥–Ω–∏–π MDMA</p>
                </div>
                <div class="product-card" data-product="mdma-5">
                    <h3 onclick="showProductModal('mdma', 5)">Street Pills (LQ Tabs)</h3>
                    <p>–£–ª–∏—á–Ω—ã–µ –ø–∏–ª—Å—ã, –±—é–¥–∂–µ—Ç–Ω—ã–π —ç–∫—Å—Ç–∞–∑–∏</p>
                </div>
            </div>

            <div id="heroin" class="tab-content">
                <div class="product-card" data-product="heroin-1">
                    <h3 onclick="showProductModal('heroin', 1)">Afghan Silk (VHQ)</h3>
                    <p>–ê—Ñ–≥–∞–Ω—Å–∫–∏–π —à—ë–ª–∫, –≥–ª—É–±–æ–∫–∏–π —Å—Ç–æ—É–Ω</p>
                </div>
                <div class="product-card" data-product="heroin-2">
                    <h3 onclick="showProductModal('heroin', 2)">White Lotus (HQ)</h3>
                    <p>–ë–µ–ª—ã–π –ª–æ—Ç–æ—Å, —á–∏—Å—Ç—ã–π —ç—Ñ—Ñ–µ–∫—Ç</p>
                </div>
                <div class="product-card" data-product="heroin-3">
                    <h3 onclick="showProductModal('heroin', 3)">Brown Sugar (MQ)</h3>
                    <p>–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π —Å–∞—Ö–∞—Ä, —Å—Ä–µ–¥–Ω–∏–π –≥–µ—Ä–æ–∏–Ω</p>
                </div>
                <div class="product-card" data-product="heroin-4">
                    <h3 onclick="showProductModal('heroin', 4)">Dirty Tar (LQ)</h3>
                    <p>–ì—Ä—è–∑–Ω–∞—è —Å–º–æ–ª–∞, –±—é–¥–∂–µ—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</p>
                </div>
                <div class="product-card" data-product="heroin-5">
                    <h3 onclick="showProductModal('heroin', 5)">Black Pearl (VHQ)</h3>
                    <p>–ß—ë—Ä–Ω–∞—è –∂–µ–º—á—É–∂–∏–Ω–∞, —ç–ª–∏—Ç–Ω—ã–π –≥–µ—Ä–æ–∏–Ω</p>
                </div>
            </div>
        </div>

        <div class="profile-menu" id="profileMenu">
            <div class="profile-info">
                <h3>üíÄ</h3>
                <p>–ò–º—è: <span id="userName">–ê–Ω–æ–Ω–∏–º</span></p>
                <p>–ë–∞–ª–∞–Ω—Å: <span id="balance">0 ‡∏ø</span></p>
                <p>–ó–∞–∫–∞–∑–æ–≤: <span id="orderCount">0</span></p>
                <p>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ –¥—Ä—É–∑–µ–π: <span id="referralCount">0</span></p>
                <p>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞: <span id="referralLink">darkthailand.com/ref123</span></p>
            </div>
            <div class="deposit-options">
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</h3>
                <button class="nav-button" onclick="showDepositModal('BTC')">Bitcoin (BTC)</button>
                <button class="nav-button" onclick="showDepositModal('ETH')">Ethereum (ETH)</button>
                <button class="nav-button" onclick="showDepositModal('USDT')">Tether (USDT)</button>
                <button class="nav-button" onclick="showDepositModal('SOL')">Solana (SOL)</button>
                <button class="nav-button" onclick="showDepositModal('TON')">Toncoin (TON)</button>
            </div>
            <div class="order-history">
                <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h3>
                <div id="orderList">–ü–æ–∫–∞ –ø—É—Å—Ç–æ, –¥–µ–ª–∞–π –∑–∞–∫–∞–∑—ã!</div>
            </div>
        </div>

        <div class="vacancy-menu" id="vacancyMenu">
            <h2>–í–∞–∫–∞–Ω—Å–∏–∏ –≤ Dark Thailand</h2>
            <div class="vacancy">
                <h3>–ö–ª–∞–¥–º–µ–Ω</h3>
                <p>–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏: –î–æ—Å—Ç–∞–≤–∫–∞ –∏ –∑–∞–∫–ª–∞–¥–∫–∞ —Ç–æ–≤–∞—Ä–∞ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º.</p>
                <p>–û–ø–ª–∞—Ç–∞: 500-1000 ‡∏ø –∑–∞ –∫–ª–∞–¥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—ä—ë–º–∞).</p>
                <button class="buy-button" onclick="applyForJob('–ö–ª–∞–¥–º–µ–Ω')">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            </div>
            <div class="vacancy">
                <h3>–°–∫–ª–∞–¥–º–µ–Ω</h3>
                <p>–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏: –£–ø–∞–∫–æ–≤–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–∞ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ.</p>
                <p>–û–ø–ª–∞—Ç–∞: 2000-3000 ‡∏ø –∑–∞ —Å–º–µ–Ω—É.</p>
                <button class="buy-button" onclick="applyForJob('–°–∫–ª–∞–¥–º–µ–Ω')">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            </div>
            <div class="vacancy">
                <h3>–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫</h3>
                <p>–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏: –ü–µ—Ä–µ–≤–æ–∑–∫–∞ —Ç–æ–≤–∞—Ä–∞ –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏ –¢–∞–∏–ª–∞–Ω–¥–∞.</p>
                <p>–û–ø–ª–∞—Ç–∞: 5000-10000 ‡∏ø –∑–∞ —Ä–µ–π—Å.</p>
                <button class="buy-button" onclick="applyForJob('–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫')">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            </div>
            <div class="vacancy">
                <h3>SMM—â–∏–∫</h3>
                <p>–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏: –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ —à–æ–ø–∞ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö –∏ —Ñ–æ—Ä—É–º–∞—Ö.</p>
                <p>–û–ø–ª–∞—Ç–∞: 3000-5000 ‡∏ø –≤ –Ω–µ–¥–µ–ª—é + –±–æ–Ω—É—Å—ã –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.</p>
                <button class="buy-button" onclick="applyForJob('SMM—â–∏–∫')">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            </div>
        </div>

        <div class="mail-menu" id="mailMenu">
            <h2>–ü–æ—á—Ç–∞</h2>
            <div id="mailList">–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π.</div>
        </div>

        <div class="product-modal" id="productModal">
            <div class="product-content" id="productContent"></div>
        </div>

        <div class="payment-modal" id="paymentModal">
            <div class="payment-content" id="paymentContent"></div>
        </div>

        <div class="deposit-modal" id="depositModal">
            <div class="deposit-content" id="depositContent"></div>
        </div>

        <div class="preorder-modal" id="preorderModal">
            <div class="preorder-content" id="preorderContent"></div>
        </div>

        <div class="registration-modal" id="registrationModal">
            <div class="registration-content" id="registrationContent">
                <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                <p>–í–≤–µ–¥–∏—Ç–µ –∂–µ–ª–∞–µ–º—ã–π –Ω–∏–∫–Ω–µ–π–º:</p>
                <input type="text" id="regNickname" placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º">
                <button class="buy-button" onclick="registerUser()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <p id="regError" style="color: #ff9999;"></p>
            </div>
        </div>

        <div class="custom-modal" id="customModal">
            <div class="custom-content" id="customContent"></div>
        </div>

        <div class="confirm-modal" id="confirmModal">
            <div class="confirm-content" id="confirmContent"></div>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
        } else {
            console.warn('Telegram Web App not available, running in offline mode');
        }

        let balance = 0;
        let orderCount = 0;
        let referralCount = 0;
        let referralDeposits = 0;
        let orderHistory = [];
        let selectedCity = 'all';
        let selectedDistrict = 'all';
        let currentUser = null;
        let mailMessages = [];
        let pendingPayments = {};
        let BTC_RATE = 2000000;
        const MIN_DEPOSIT = 1000;

        const BOT_B_TOKEN = '7589545725:AAHoedAqoGh_k0WWdUs1rcBN1yddUtBFhsk';
        const ADMIN_CHAT_ID = '5956080955'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à chat_id

        const testAddresses = {
            BTC: "1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa",
            ETH: "0x32Be343B94f860124dC4fEe278FDCBD38C102D88",
            USDT: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
            SOL: "5yK7e5a8j9k2m3n4p5q6r7s8t9u0v1w2x3y4z5A6B7C8D9E0F1G2H",
            TON: "EQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM9c"
        };

        const cities = {
            "phuket": {
                "–ü–∞—Ç–æ–Ω–≥": { lat: "7.891", lon: "98.298", desc: "–ü–æ–¥ –ø–∞–ª—å–º–æ–π —É —Ç—Ä–µ—Ç—å–µ–≥–æ —à–µ–∑–ª–æ–Ω–≥–∞, –∑–∞–∫–æ–ø–∞–Ω–æ –≤ –ø–µ—Å–∫–µ, —á—ë—Ä–Ω—ã–π –ø–∞–∫–µ—Ç." },
                "–ö–∞—Ä–æ–Ω": { lat: "7.846", lon: "98.295", desc: "–ü–æ–¥ –∫–∞–º–Ω–µ–º —É –∑–∞–±–æ—Ä–∞, –º–∞–≥–Ω–∏—Ç –≤ —Å–∏–Ω–µ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–ü—Ö—É–∫–µ—Ç-—Ç–∞—É–Ω": { lat: "7.883", lon: "98.391", desc: "–í –∫—É—Å—Ç–∞—Ö –∑–∞ —Å—Ç–∞—Ä—ã–º –ª–∞—Ä—å–∫–æ–º, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ –∑–µ–ª—ë–Ω—É—é –ø–ª—ë–Ω–∫—É." },
                "–ö–∞—Ç–∞": { lat: "7.820", lon: "98.299", desc: "–ü–æ–¥ —Å–∫–∞–º–µ–π–∫–æ–π —É –ø–ª—è–∂–∞, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ —á—ë—Ä–Ω—É—é –ø–ª—ë–Ω–∫—É." },
                "–ß–∞–ª–æ–Ω–≥": { lat: "7.831", lon: "98.339", desc: "–ó–∞ –≤—ã–≤–µ—Å–∫–æ–π —É –ø–∏—Ä—Å–∞, –º–∞–≥–Ω–∏—Ç –≤ –∫—Ä–∞—Å–Ω–æ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–ö–∞–º–∞–ª–∞": { lat: "7.952", lon: "98.284", desc: "–ü–æ–¥ –∫—É—Å—Ç–æ–º —É –¥–æ—Ä–æ–≥–∏, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ —Å–µ—Ä—É—é —Ç–∫–∞–Ω—å." },
                "–ú–∞–π –ö—Ö–∞–æ": { lat: "8.130", lon: "98.298", desc: "–í –ø–µ—Å–∫–µ —É –∑–∞–±—Ä–æ—à–µ–Ω–Ω–æ–≥–æ –ª–∞—Ä—å–∫–∞, —á—ë—Ä–Ω—ã–π –ø–∞–∫–µ—Ç." }
            },
            "pattaya": {
                "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ü–∞—Ç—Ç–∞–π—è": { lat: "12.935", lon: "100.887", desc: "–í —â–µ–ª–∏ —Å—Ç–µ–Ω—ã —É –±–∞—Ä–∞, –º–∞–≥–Ω–∏—Ç –≤ –∫—Ä–∞—Å–Ω–æ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–î–∂–æ–º—Ç—å–µ–Ω": { lat: "12.903", lon: "100.869", desc: "–ü–æ–¥ –∫—É—Å—Ç–æ–º —É –¥–æ—Ä–æ–≥–∏, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ —Å–µ—Ä—É—é —Ç–∫–∞–Ω—å." },
                "–ù–∞–∫–ª—É–∞": { lat: "12.970", lon: "100.900", desc: "–ó–∞ –º—É—Å–æ—Ä–∫–æ–π —É —Ä—ã–Ω–∫–∞, —á—ë—Ä–Ω—ã–π –ø–∞–∫–µ—Ç." },
                "–Æ–∂–Ω–∞—è –ü–∞—Ç—Ç–∞–π—è": { lat: "12.923", lon: "100.882", desc: "–ü–æ–¥ –∫–∞–º–Ω–µ–º —É –ø–∏—Ä—Å–∞, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ –∑–µ–ª—ë–Ω—É—é –ø–ª—ë–Ω–∫—É." },
                "–í–æ–Ω–≥ –ê–º–∞—Ç": { lat: "12.963", lon: "100.885", desc: "–ü–æ–¥ —Å–∫–∞–º–µ–π–∫–æ–π —É –ø–ª—è–∂–∞, –º–∞–≥–Ω–∏—Ç –≤ –∂—ë–ª—Ç–æ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–ü—Ä–∞—Ç–∞–º–Ω–∞–∫": { lat: "12.918", lon: "100.865", desc: "–í –∫—É—Å—Ç–∞—Ö —É —Ö–æ–ª–º–∞, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ —á—ë—Ä–Ω—É—é –ø–ª—ë–Ω–∫—É." }
            },
            "bangkok": {
                "–°—É–∫—Ö—É–º–≤–∏—Ç": { lat: "13.736", lon: "100.561", desc: "–í —â–µ–ª–∏ —Å—Ç–µ–Ω—ã —É –º–µ—Ç—Ä–æ, –º–∞–≥–Ω–∏—Ç –≤ –∂—ë–ª—Ç–æ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–ö–∞–æ—Å–∞–Ω": { lat: "13.759", lon: "100.497", desc: "–ü–æ–¥ —Å–∫–∞–º–µ–π–∫–æ–π —É —Ö–æ—Å—Ç–µ–ª–∞, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ —á—ë—Ä–Ω—É—é –ø–ª—ë–Ω–∫—É." },
                "–°–∏–ª–æ–º": { lat: "13.723", lon: "100.535", desc: "–ó–∞ –≤—ã–≤–µ—Å–∫–æ–π —É –±–∞—Ä–∞, –º–∞–≥–Ω–∏—Ç –≤ —Å–∏–Ω–µ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–ß–∞—Ç—É—á–∞–∫": { lat: "13.799", lon: "100.548", desc: "–í –∫—É—Å—Ç–∞—Ö —É —Ä—ã–Ω–∫–∞, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ —Å–µ—Ä—É—é —Ç–∫–∞–Ω—å." },
                "–†–∞—Ç—á–∞–¥–∞": { lat: "13.779", lon: "100.573", desc: "–ü–æ–¥ –º–æ—Å—Ç–æ–º —É –º–µ—Ç—Ä–æ, –º–∞–≥–Ω–∏—Ç –≤ –∑–µ–ª—ë–Ω–æ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–ë–∞–Ω–≥–ª–∞–º–ø—Ö—É": { lat: "13.760", lon: "100.501", desc: "–ó–∞ –ª–∞—Ä—å–∫–æ–º —É –∫–∞–Ω–∞–ª–∞, —á—ë—Ä–Ω—ã–π –ø–∞–∫–µ—Ç." }
            },
            "samui": {
                "–ß–∞–≤–µ–Ω–≥": { lat: "9.520", lon: "100.057", desc: "–ü–æ–¥ —à–µ–∑–ª–æ–Ω–≥–æ–º —É –±–∞—Ä–∞, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ —á—ë—Ä–Ω—ã–π –ø–∞–∫–µ—Ç." },
                "–õ–∞–º–∞–π": { lat: "9.470", lon: "100.047", desc: "–í –∫—É—Å—Ç–∞—Ö —É –¥–æ—Ä–æ–≥–∏, –º–∞–≥–Ω–∏—Ç –≤ –∑–µ–ª—ë–Ω–æ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–ë–æ –ü—Ö—É—Ç": { lat: "9.560", lon: "100.031", desc: "–ü–æ–¥ –∫–∞–º–Ω–µ–º —É –ø–∏—Ä—Å–∞, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ —Å–µ—Ä—É—é —Ç–∫–∞–Ω—å." },
                "–ú–∞–µ–Ω–∞–º": { lat: "9.573", lon: "100.000", desc: "–ó–∞ –º—É—Å–æ—Ä–∫–æ–π —É –ø–ª—è–∂–∞, —á—ë—Ä–Ω—ã–π –ø–∞–∫–µ—Ç." },
                "–õ–∏–ø–∞ –ù–æ–π": { lat: "9.498", lon: "99.935", desc: "–ü–æ–¥ –ø–∞–ª—å–º–æ–π —É –±–µ—Ä–µ–≥–∞, –º–∞–≥–Ω–∏—Ç –≤ —Å–∏–Ω–µ–π –∏–∑–æ–ª–µ–Ω—Ç–µ." },
                "–ë–∞–Ω–≥ –ü–æ": { lat: "9.580", lon: "99.970", desc: "–í –ø–µ—Å–∫–µ —É –∑–∞–±–æ—Ä–∞, –∑–∞–≤—ë—Ä–Ω—É—Ç–æ –≤ –∑–µ–ª—ë–Ω—É—é –ø–ª—ë–Ω–∫—É." }
            }
        };

        const weights = {
            default: [1, 2, 3, 5, 10, 15, 20],
            cokeMephAlphaMdma: [0.5, 1, 2, 3, 5, 10, 15, 20],
            lsd: [1, 2, 5, 10], // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ä–æ–∫
            mdmaTabs: [1, 2, 5] // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–±–ª–µ—Ç–æ–∫
        };

        const basePrices = {
            weed: { 1: 1500 },
            hash: { 1: 900, 2: 700, 3: 500, 4: 400, 5: 1000 },
            coke: { 1: 4000, 2: 3600, 3: 3000, 4: 2400, 5: 4500 },
            amph: { 1: 1300, 2: 1000, 3: 900, 4: 700, 5: 1500 },
            meth: { 1: 1500, 2: 1200, 3: 1000, 4: 800, 5: 1800 },
            meph: { 1: 1400, 2: 1100, 3: 900, 4: 700, 5: 1600 },
            alpha: { 1: 1200, 2: 1000, 3: 800, 4: 600, 5: 1400 },
            lsd: { 1: 500, 2: 450, 3: 400, 4: 350, 5: 600 }, // –¶–µ–Ω–∞ –∑–∞ –º–∞—Ä–∫—É
            mdma: { 1: 1500, 2: 1200, 3: 600, 4: 1000, 5: 400 }, // 3 –∏ 5 - —Ç–∞–±–ª–µ—Ç–∫–∏
            heroin: { 1: 2000, 2: 1800, 3: 1500, 4: 1200, 5: 2500 }
        };

        const products = {
            weed: {
                1: { name: "Jamaican Haze (VHQ)", positions: generatePositions('weed', 1, 'default'), reviews: [] }
            },
            hash: {
                1: { name: "Afghan Black Gold (VHQ)", positions: generatePositions('hash', 1, 'default'), reviews: [{ text: "–ß—ë—Ä–Ω–æ–µ –∑–æ–ª–æ—Ç–æ ‚Äî —ç—Ç–æ –±–æ–º–±–∞! –ú—è–≥–∫–∏–π –∏ –º–æ—â–Ω—ã–π, —Ç–æ–ø –∑–∞ —Å–≤–æ–∏ –¥–µ–Ω—å–≥–∏! ‚Äî –ê–Ω–æ–Ω–∏–º", mod: `–†–∞–¥—ã, —á—Ç–æ –≤–∞–º –∑–∞—à–ª–æ! –ü—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ ${getRandomPromoGood()} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –∑–∞ –æ—Ç–∑—ã–≤! ‚Äî Dark Thailand` }] },
                2: { name: "Moroccan Spice (HQ)", positions: generatePositions('hash', 2, 'default'), reviews: [] },
                3: { name: "Nepal Temple (MQ)", positions: generatePositions('hash', 3, 'default'), reviews: [] },
                4: { name: "Local Dust (LQ)", positions: generatePositions('hash', 4, 'default'), reviews: [] },
                5: { name: "Himalayan Storm (VHQ)", positions: generatePositions('hash', 5, 'default'), reviews: [] }
            },
            coke: {
                1: { name: "Bolivian Fishscale (VHQ)", positions: generatePositions('coke', 1, 'cokeMephAlphaMdma'), reviews: [] },
                2: { name: "Colombian Snow (HQ)", positions: generatePositions('coke', 2, 'cokeMephAlphaMdma'), reviews: [] },
                3: { name: "Peruvian Dust (MQ)", positions: generatePositions('coke', 3, 'cokeMephAlphaMdma'), reviews: [] },
                4: { name: "Street Mix (LQ)", positions: generatePositions('coke', 4, 'cokeMephAlphaMdma'), reviews: [] },
                5: { name: "Cartel Gold (VHQ)", positions: generatePositions('coke', 5, 'cokeMephAlphaMdma'), reviews: [] }
            },
            amph: {
                1: { name: "Crystal Surge (VHQ)", positions: generatePositions('amph', 1, 'default'), reviews: [] },
                2: { name: "Red Rush (HQ)", positions: generatePositions('amph', 2, 'default'), reviews: [] },
                3: { name: "Yellow Spark (MQ)", positions: generatePositions('amph', 3, 'default'), reviews: [] },
                4: { name: "Grey Haze (LQ)", positions: generatePositions('amph', 4, 'default'), reviews: [] },
                5: { name: "Blue Blitz (VHQ)", positions: generatePositions('amph', 5, 'default'), reviews: [] }
            },
            meth: {
                1: { name: "Mountain Ice (VHQ)", positions: generatePositions('meth', 1, 'default'), reviews: [] },
                2: { name: "Blue Flame (HQ)", positions: generatePositions('meth', 2, 'default'), reviews: [] },
                3: { name: "White Shard (MQ)", positions: generatePositions('meth', 3, 'default'), reviews: [] },
                4: { name: "Dirty Crystal (LQ)", positions: generatePositions('meth', 4, 'default'), reviews: [] },
                5: { name: "Golden Shard (VHQ)", positions: generatePositions('meth', 5, 'default'), reviews: [] }
            },
            meph: {
                1: { name: "Pink Bliss (VHQ)", positions: generatePositions('meph', 1, 'cokeMephAlphaMdma'), reviews: [] },
                2: { name: "White Surge (HQ)", positions: generatePositions('meph', 2, 'cokeMephAlphaMdma'), reviews: [] },
                3: { name: "Grey Mist (MQ)", positions: generatePositions('meph', 3, 'cokeMephAlphaMdma'), reviews: [] },
                4: { name: "Dusty High (LQ)", positions: generatePositions('meph', 4, 'cokeMephAlphaMdma'), reviews: [] },
                5: { name: "Red Pulse (VHQ)", positions: generatePositions('meph', 5, 'cokeMephAlphaMdma'), reviews: [] }
            },
            alpha: {
                1: { name: "Flakka Fire (VHQ)", positions: generatePositions('alpha', 1, 'cokeMephAlphaMdma'), reviews: [] },
                2: { name: "Purple Haze (HQ)", positions: generatePositions('alpha', 2, 'cokeMephAlphaMdma'), reviews: [] },
                3: { name: "Green Dust (MQ)", positions: generatePositions('alpha', 3, 'cokeMephAlphaMdma'), reviews: [] },
                4: { name: "Street Gravel (LQ)", positions: generatePositions('alpha', 4, 'cokeMephAlphaMdma'), reviews: [] },
                5: { name: "Crystal Fury (VHQ)", positions: generatePositions('alpha', 5, 'cokeMephAlphaMdma'), reviews: [] }
            },
            lsd: {
                1: { name: "Cosmic Tabs (VHQ)", positions: generatePositions('lsd', 1, 'lsd'), reviews: [] },
                2: { name: "Neon Drops (HQ)", positions: generatePositions('lsd', 2, 'lsd'), reviews: [] },
                3: { name: "Acid Rain (MQ)", positions: generatePositions('lsd', 3, 'lsd'), reviews: [] },
                4: { name: "Street Blotters (LQ)", positions: generatePositions('lsd', 4, 'lsd'), reviews: [] },
                5: { name: "Galactic Hits (VHQ)", positions: generatePositions('lsd', 5, 'lsd'), reviews: [] }
            },
            mdma: {
                1: { name: "Crystal Love (VHQ)", positions: generatePositions('mdma', 1, 'cokeMephAlphaMdma'), reviews: [] },
                2: { name: "Pink Rocks (HQ)", positions: generatePositions('mdma', 2, 'cokeMephAlphaMdma'), reviews: [] },
                3: { name: "Ecstasy Blue (VHQ Tabs)", positions: generatePositions('mdma', 3, 'mdmaTabs'), reviews: [] },
                4: { name: "Molly Dust (MQ)", positions: generatePositions('mdma', 4, 'cokeMephAlphaMdma'), reviews: [] },
                5: { name: "Street Pills (LQ Tabs)", positions: generatePositions('mdma', 5, 'mdmaTabs'), reviews: [] }
            },
            heroin: {
                1: { name: "Afghan Silk (VHQ)", positions: generatePositions('heroin', 1, 'default'), reviews: [] },
                2: { name: "White Lotus (HQ)", positions: generatePositions('heroin', 2, 'default'), reviews: [] },
                3: { name: "Brown Sugar (MQ)", positions: generatePositions('heroin', 3, 'default'), reviews: [] },
                4: { name: "Dirty Tar (LQ)", positions: generatePositions('heroin', 4, 'default'), reviews: [] },
                5: { name: "Black Pearl (VHQ)", positions: generatePositions('heroin', 5, 'default'), reviews: [] }
            }
        };

        function generatePositions(category, productId, weightType) {
            const applicableWeights = weights[weightType];
            const positions = [];
            let id = 1;

            for (const city in cities) {
                for (const district in cities[city]) {
                    applicableWeights.forEach(weight => {
                        const basePricePerUnit = basePrices[category][productId];
                        const price = Math.round(basePricePerUnit * weight * (city === 'samui' ? 1.5 : 1));
                        const cryptoPrice = (price / BTC_RATE).toFixed(5);
                        const inStock = (category === 'weed' && weight <= 5) || Math.random() > 0.2;
                        positions.push({
                            id: id++,
                            weight,
                            price,
                            cryptoPrice,
                            city,
                            district,
                            inStock
                        });
                    });
                }
            }
            return positions;
        }

        function fetchBTCRate() {
            fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=thb')
                .then(response => response.json())
                .then(data => {
                    BTC_RATE = data.bitcoin.thb;
                    console.log(`–ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫—É—Ä—Å BTC/THB: ${BTC_RATE}`);
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–∞ BTC:', error);
                    BTC_RATE = 2000000;
                });
        }

        function getRandomDate() {
            const day = Math.floor(Math.random() * 28) + 1;
            return `${day < 10 ? '0' + day : day}.03.2025`;
        }

        function getRandomPromoGood() {
            const promos = ["5%", "10%", "15%"];
            return promos[Math.floor(Math.random() * promos.length)];
        }

        function getRandomCoordinates(city, district) {
            const baseLat = parseFloat(cities[city][district].lat);
            const baseLon = parseFloat(cities[city][district].lon);
            const offset = 0.005;
            const randomLat = (baseLat + (Math.random() * offset * 2 - offset)).toFixed(3);
            const randomLon = (baseLon + (Math.random() * offset * 2 - offset)).toFixed(3);
            return { lat: randomLat, lon: randomLon };
        }

        function generateUniqueAddress(crypto) {
            const baseAddress = testAddresses[crypto];
            const randomSuffix = Math.random().toString(36).substring(2, 8);
            return `${baseAddress}-${randomSuffix}`;
        }

        function sendToTelegramBot(message, paymentId, amount) {
            if (!window.Telegram || !window.Telegram.WebApp) {
                console.log('Telegram not available, skipping send:', message);
                return;
            }
            const chatId = window.Telegram.WebApp.initDataUnsafe.user?.id || 'unknown';
            const fullMessage = `${message}\nchat_id: ${chatId}`;
            const keyboard = paymentId ? {
                inline_keyboard: [
                    [
                        { text: '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å', callback_data: `confirm_${paymentId}_${amount}_${chatId}` },
                        { text: '‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å', callback_data: `reject_${paymentId}_${chatId}` }
                    ]
                ]
            } : null;
            fetch(`https://api.telegram.org/bot${BOT_B_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: ADMIN_CHAT_ID,
                    text: fullMessage,
                    reply_markup: keyboard
                })
            })
                .then(response => response.json())
                .then(data => console.log('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ:', data))
                .catch(error => console.error('–û—à–∏–±–∫–∞:', error));
        }

        function toggleCatalog() {
            const catalog = document.getElementById('catalogMenu');
            const profile = document.getElementById('profileMenu');
            const vacancy = document.getElementById('vacancyMenu');
            const mail = document.getElementById('mailMenu');
            catalog.style.display = catalog.style.display === 'block' ? 'none' : 'block';
            profile.style.display = 'none';
            vacancy.style.display = 'none';
            mail.style.display = 'none';
            if (catalog.style.display === 'block') {
                document.querySelector('.tab').click();
                updateDistrictFilter();
            }
        }

        function toggleProfile() {
            const catalog = document.getElementById('catalogMenu');
            const profile = document.getElementById('profileMenu');
            const vacancy = document.getElementById('vacancyMenu');
            const mail = document.getElementById('mailMenu');
            profile.style.display = profile.style.display === 'block' ? 'none' : 'block';
            catalog.style.display = 'none';
            vacancy.style.display = 'none';
            mail.style.display = 'none';
            if (profile.style.display === 'block') updateProfile();
        }

        function toggleVacancies() {
            const catalog = document.getElementById('catalogMenu');
            const profile = document.getElementById('profileMenu');
            const vacancy = document.getElementById('vacancyMenu');
            const mail = document.getElementById('mailMenu');
            vacancy.style.display = vacancy.style.display === 'block' ? 'none' : 'block';
            catalog.style.display = 'none';
            profile.style.display = 'none';
            mail.style.display = 'none';
        }

        function toggleMail() {
            const catalog = document.getElementById('catalogMenu');
            const profile = document.getElementById('profileMenu');
            const vacancy = document.getElementById('vacancyMenu');
            const mail = document.getElementById('mailMenu');
            mail.style.display = mail.style.display === 'block' ? 'none' : 'block';
            catalog.style.display = 'none';
            profile.style.display = 'none';
            vacancy.style.display = 'none';
            updateMail();
        }

        function updateProfile() {
            document.getElementById('userName').innerText = currentUser || '–ê–Ω–æ–Ω–∏–º';
            document.getElementById('balance').innerText = `${balance} ‡∏ø`;
            document.getElementById('orderCount').innerText = orderCount;
            document.getElementById('referralCount').innerText = referralCount;
            document.getElementById('referralLink').innerText = `https://t.me/DarkThailandBot?start=${currentUser || 'guest'}`;
            const orderList = document.getElementById('orderList');
            orderList.innerHTML = orderHistory.length > 0 ? orderHistory.map(order => `<p>${order.date}: ${order.product} - ${order.price} ‡∏ø</p>`).join('') : '–ü–æ–∫–∞ –ø—É—Å—Ç–æ, –¥–µ–ª–∞–π –∑–∞–∫–∞–∑—ã!';
            checkReferralBonus();
        }

        function showRegistration() {
            const modal = document.getElementById('registrationModal');
            modal.style.display = 'flex';
            document.getElementById('regNickname').value = '';
            document.getElementById('regError').innerText = '';
            modal.onclick = (e) => { if (e.target === modal) modal.style.display = 'none'; };
        }

        function registerUser() {
            const nickname = document.getElementById('regNickname').value.trim();
            if (!nickname) {
                document.getElementById('regError').innerText = '–ù–∏–∫–Ω–µ–π–º –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!';
                return;
            }
            try {
                let users = JSON.parse(localStorage.getItem('users')) || [];
                if (users.includes(nickname)) {
                    document.getElementById('regError').innerText = '–≠—Ç–æ—Ç –Ω–∏–∫–Ω–µ–π–º —É–∂–µ –∑–∞–Ω—è—Ç!';
                    return;
                }
                users.push(nickname);
                localStorage.setItem('users', JSON.stringify(users));
                localStorage.setItem('currentUser', nickname);
                currentUser = nickname;
                document.getElementById('registrationModal').style.display = 'none';
                document.querySelector('.nav').style.display = 'flex';
                sendToTelegramBot(`üÜï –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${nickname}`);
                addMailMessage(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser}! –í–∞—à –∞–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω.`);
                updateProfile();
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ localStorage:', e);
                currentUser = nickname;
                document.getElementById('registrationModal').style.display = 'none';
                document.querySelector('.nav').style.display = 'flex';
                sendToTelegramBot(`üÜï –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${nickname} (—Å –æ—à–∏–±–∫–æ–π localStorage)`);
                addMailMessage(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser}! –í–∞—à –∞–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω.`);
                updateProfile();
            }
        }

        window.onload = function() {
            fetchBTCRate();
            try {
                const storedUser = localStorage.getItem('currentUser');
                if (storedUser) {
                    currentUser = storedUser;
                    document.getElementById('userName').innerText = storedUser;
                    document.querySelector('.nav').style.display = 'flex';
                } else {
                    showRegistration();
                    document.querySelector('.nav').style.display = 'none';
                }
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:', e);
                showRegistration();
                document.querySelector('.nav').style.display = 'none';
            }
        };

        function updateMail() {
            const mailList = document.getElementById('mailList');
            mailList.innerHTML = mailMessages.length > 0 ? mailMessages.map(msg => `<p>${msg.date}: ${msg.text}</p>`).join('') : '–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π.';
        }

        function addMailMessage(text) {
            mailMessages.unshift({ date: new Date().toLocaleString(), text });
            updateMail();
        }

        function filterByCity() {
            selectedCity = document.getElementById('citySelect').value;
            updateDistrictFilter();
            filterProducts(document.querySelector('.tab.active')?.getAttribute('data-tab') || 'weed');
        }

        function updateDistrictFilter() {
            const districtSelect = document.getElementById('districtSelect');
            districtSelect.innerHTML = '<option value="all">–í—Å–µ —Ä–∞–π–æ–Ω—ã</option>';
            if (selectedCity !== 'all') {
                for (const district in cities[selectedCity]) {
                    const option = document.createElement('option');
                    option.value = district;
                    option.text = district;
                    districtSelect.appendChild(option);
                }
            }
            selectedDistrict = 'all';
        }

        function filterByDistrict() {
            selectedDistrict = document.getElementById('districtSelect').value;
            filterProducts(document.querySelector('.tab.active')?.getAttribute('data-tab') || 'weed');
        }

        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.style.display = 'none';
                });
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const tabContent = document.getElementById(tab.getAttribute('data-tab'));
                tabContent.style.display = 'block';
                filterProducts(tab.getAttribute('data-tab'));
            });
        });

        function filterProducts(category) {
            const productsInCategory = document.querySelectorAll(`#${category} .product-card`);
            productsInCategory.forEach(card => {
                const productId = card.getAttribute('data-product').split('-')[1];
                const product = products[category][productId];
                const hasMatch = product.positions.some(pos => 
                    (selectedCity === 'all' || pos.city === selectedCity) &&
                    (selectedDistrict === 'all' || pos.district === selectedDistrict)
                );
                card.style.display = hasMatch ? 'block' : 'none';
            });
        }

        function showProductModal(category, id) {
            if (!currentUser) {
                showRegistration();
                return;
            }
            const product = products[category][id];
            const modal = document.getElementById('productModal');
            const content = document.getElementById('productContent');
            const isLsd = category === 'lsd';
            const isMdmaTabs = category === 'mdma' && (id === 3 || id === 5);
            let html = `<h2>${product.name}</h2>`;
            html += '<h3>–ü–æ–∑–∏—Ü–∏–∏:</h3>';
            product.positions.forEach(pos => {
                if ((selectedCity === 'all' || pos.city === selectedCity) && 
                    (selectedDistrict === 'all' || pos.district === selectedDistrict)) {
                    const preorderPrice = Math.round(pos.price * 1.3);
                    const preorderCryptoPrice = (pos.cryptoPrice * 1.3).toFixed(5);
                    html += `<div class="position">
                        <p>–í–µ—Å: ${pos.weight} ${isLsd ? '–º–∞—Ä–æ–∫' : isMdmaTabs ? '—Ç–∞–±–ª–µ—Ç–æ–∫' : '–≥'}</p>
                        <p class="price">${pos.price} ‡∏ø (~${pos.cryptoPrice} BTC)</p>
                        <p>–ì–æ—Ä–æ–¥: ${pos.city === 'phuket' ? '–ü—Ö—É–∫–µ—Ç' : pos.city === 'pattaya' ? '–ü–∞—Ç—Ç–∞–π—è' : pos.city === 'bangkok' ? '–ë–∞–Ω–≥–∫–æ–∫' : '–æ. –°–∞–º—É–∏'}, ${pos.district}</p>
                        <p>–ù–∞–ª–∏—á–∏–µ: ${pos.inStock ? '–í –Ω–∞–ª–∏—á–∏–∏' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}</p>
                        ${pos.inStock ? `<button class="buy-button" onclick="buyProduct('${category}', ${id}, ${pos.id})">–ö—É–ø–∏—Ç—å</button>` : ''}
                        <button class="preorder-button" onclick="preorderProduct('${category}', ${id}, ${pos.id}, ${preorderPrice}, '${preorderCryptoPrice}')">–ü—Ä–µ–¥–∑–∞–∫–∞–∑ (+30%)</button>
                    </div>`;
                }
            });
            html += '<h3>–û—Ç–∑—ã–≤—ã:</h3>';
            product.reviews.forEach(review => {
                html += `<div class="review">${review.text}</div>`;
                if (review.mod) html += `<div class="moderator-response">${review.mod}</div>`;
            });
            html += `<button class="buy-button" onclick="document.getElementById('productModal').style.display='none';">–ó–∞–∫—Ä—ã—Ç—å</button>`;
            content.innerHTML = html;
            modal.style.display = 'flex';
            modal.onclick = (e) => {
                if (e.target === modal) modal.style.display = 'none';
            };
        }

        function buyProduct(category, productId, positionId) {
            const product = products[category][productId];
            const position = product.positions.find(pos => pos.id === positionId);
            if (!position.inStock) {
                alert('–¢–æ–≤–∞—Ä–∞ –Ω–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏!');
                return;
            }
            if (balance < position.price) {
                showCustomConfirm('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ! –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å?', 
                    () => {
                        toggleProfile();
                        document.getElementById('productModal').style.display = 'none';
                    }, 
                    () => {}
                );
                return;
            }
            balance -= position.price;
            orderCount++;
            orderHistory.unshift({ date: new Date().toLocaleDateString(), product: `${product.name} (${position.weight} ${category === 'lsd' ? '–º–∞—Ä–æ–∫' : (category === 'mdma' && (productId === 3 || productId === 5)) ? '—Ç–∞–±–ª–µ—Ç–æ–∫' : '–≥'})`, price: position.price });
            position.inStock = false;
            const modal = document.getElementById('paymentModal');
            const content = document.getElementById('paymentContent');
            const coords = getRandomCoordinates(position.city, position.district);
            const cityInfo = cities[position.city][position.district];
            content.innerHTML = `
                <h2>–û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞!</h2>
                <p>–¢–æ–≤–∞—Ä: ${product.name}</p>
                <p>–í–µ—Å: ${position.weight} ${category === 'lsd' ? '–º–∞—Ä–æ–∫' : (category === 'mdma' && (productId === 3 || productId === 5)) ? '—Ç–∞–±–ª–µ—Ç–æ–∫' : '–≥'}</p>
                <p>–°—É–º–º–∞: ${position.price} ‡∏ø (~${position.cryptoPrice} BTC)</p>
                <p>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${coords.lat}, ${coords.lon}</p>
                <p>–û–ø–∏—Å–∞–Ω–∏–µ: ${cityInfo.desc}</p>
                <button class="buy-button" onclick="document.getElementById('paymentModal').style.display='none';updateProfile();">–ó–∞–∫—Ä—ã—Ç—å</button>
            `;
            modal.style.display = 'flex';
            document.getElementById('productModal').style.display = 'none';
            sendToTelegramBot(`üõí –ù–æ–≤—ã–π –∑–∞–∫–∞–∑:\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${currentUser}\n–¢–æ–≤–∞—Ä: ${product.name}\n–í–µ—Å: ${position.weight} ${category === 'lsd' ? '–º–∞—Ä–æ–∫' : (category === 'mdma' && (productId === 3 || productId === 5)) ? '—Ç–∞–±–ª–µ—Ç–æ–∫' : '–≥'}\n–¶–µ–Ω–∞: ${position.price} ‡∏ø\n–ì–æ—Ä–æ–¥: ${position.city}, ${position.district}`);
            addMailMessage(`–í—ã —É—Å–ø–µ—à–Ω–æ –∫—É–ø–∏–ª–∏ ${product.name} (${position.weight} ${category === 'lsd' ? '–º–∞—Ä–æ–∫' : (category === 'mdma' && (productId === 3 || productId === 5)) ? '—Ç–∞–±–ª–µ—Ç–æ–∫' : '–≥'}) –∑–∞ ${position.price} ‡∏ø. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${coords.lat}, ${coords.lon}. –û–ø–∏—Å–∞–Ω–∏–µ: ${cityInfo.desc}`);
            modal.onclick = (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                    updateProfile();
                }
            };
        }

        function preorderProduct(category, productId, positionId, preorderPrice, preorderCryptoPrice) {
            const product = products[category][productId];
            const position = product.positions.find(pos => pos.id === positionId);
            const modal = document.getElementById('preorderModal');
            const content = document.getElementById('preorderContent');
            const unit = category === 'lsd' ? '–º–∞—Ä–æ–∫' : (category === 'mdma' && (productId === 3 || productId === 5)) ? '—Ç–∞–±–ª–µ—Ç–æ–∫' : '–≥';
            content.innerHTML = `
                <h2>–ü—Ä–µ–¥–∑–∞–∫–∞–∑</h2>
                <p>–¢–æ–≤–∞—Ä: ${product.name}</p>
                <p>–í–µ—Å: ${position.weight} ${unit}</p>
                <p>–°—É–º–º–∞: ${preorderPrice} ‡∏ø (~${preorderCryptoPrice} BTC)</p>
                <p>–ö–ª–∞–¥ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω –≤ –∂–µ–ª–∞–µ–º–æ–π –ª–æ–∫–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã.</p>
                <button class="buy-button" onclick="confirmPreorder('${category}', ${productId}, ${positionId}, ${preorderPrice}, '${preorderCryptoPrice}')">–°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥–∑–∞–∫–∞–∑</button>
                <button class="buy-button" onclick="document.getElementById('preorderModal').style.display='none';">–ó–∞–∫—Ä—ã—Ç—å</button>
            `;
            modal.style.display = 'flex';
            modal.onclick = (e) => {
                if (e.target === modal) modal.style.display = 'none';
            };
        }

        function confirmPreorder(category, productId, positionId, preorderPrice, preorderCryptoPrice) {
            const product = products[category][productId];
            const position = product.positions.find(pos => pos.id === positionId);
            const unit = category === 'lsd' ? '–º–∞—Ä–æ–∫' : (category === 'mdma' && (productId === 3 || productId === 5)) ? '—Ç–∞–±–ª–µ—Ç–æ–∫' : '–≥';
            if (balance < preorderPrice) {
                showCustomConfirm('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ! –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å?', 
                    () => {
                        toggleProfile();
                        document.getElementById('preorderModal').style.display = 'none';
                    }, 
                    () => {
                        document.getElementById('preorderModal').style.display = 'none';
                    }
                );
                return;
            }
            balance -= preorderPrice;
            orderCount++;
            orderHistory.unshift({ date: new Date().toLocaleDateString(), product: `${product.name} (${position.weight} ${unit}, –ø—Ä–µ–¥–∑–∞–∫–∞–∑)`, price: preorderPrice });
            showCustomPrompt('–£–∫–∞–∂–∏—Ç–µ –∂–µ–ª–∞–µ–º—É—é –ª–æ–∫–∞—Ü–∏—é –¥–ª—è –∫–ª–∞–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ü—Ö—É–∫–µ—Ç, –ü–∞—Ç–æ–Ω–≥, —É –±–∞—Ä–∞ X):', (location) => {
                const modal = document.getElementById('paymentModal');
                const content = document.getElementById('paymentContent');
                const coords = getRandomCoordinates(position.city, position.district);
                if (!location) {
                    content.innerHTML = `
                        <h2>–ü—Ä–µ–¥–∑–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</h2>
                        <p>–¢–æ–≤–∞—Ä: ${product.name}</p>
                        <p>–í–µ—Å: ${position.weight} ${unit}</p>
                        <p>–°—É–º–º–∞: ${preorderPrice} ‡∏ø (~${preorderCryptoPrice} BTC)</p>
                        <p>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${coords.lat}, ${coords.lon}</p>
                        <p>–ö–ª–∞–¥ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω –≤ —Å–ª—É—á–∞–π–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏ –≤ —Ä–∞–π–æ–Ω–µ ${position.city === 'phuket' ? '–ü—Ö—É–∫–µ—Ç' : position.city === 'pattaya' ? '–ü–∞—Ç—Ç–∞–π—è' : position.city === 'bangkok' ? '–ë–∞–Ω–≥–∫–æ–∫' : '–æ. –°–∞–º—É–∏'}, ${position.district}.</p>
                        <p>–û–∂–∏–¥–∞–π—Ç–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤!</p>
                        <button class="buy-button" onclick="document.getElementById('paymentModal').style.display='none';updateProfile();">–ó–∞–∫—Ä—ã—Ç—å</button>
                    `;
                } else {
                    content.innerHTML = `
                        <h2>–ü—Ä–µ–¥–∑–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</h2>
                        <p>–¢–æ–≤–∞—Ä: ${product.name}</p>
                        <p>–í–µ—Å: ${position.weight} ${unit}</p>
                        <p>–°—É–º–º–∞: ${preorderPrice} ‡∏ø (~${preorderCryptoPrice} BTC)</p>
                        <p>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${coords.lat}, ${coords.lon}</p>
                        <p>–ö–ª–∞–¥ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω —Ä—è–¥–æ–º —Å: ${location}</p>
                        <p>–û–∂–∏–¥–∞–π—Ç–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤!</p>
                        <button class="buy-button" onclick="document.getElementById('paymentModal').style.display='none';updateProfile();">–ó–∞–∫—Ä—ã—Ç—å</button>
                    `;
                }
                modal.style.display = 'flex';
                document.getElementById('preorderModal').style.display = 'none';
                sendToTelegramBot(`üì¶ –ü—Ä–µ–¥–∑–∞–∫–∞–∑:\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${currentUser}\n–¢–æ–≤–∞—Ä: ${product.name}\n–í–µ—Å: ${position.weight} ${unit}\n–¶–µ–Ω–∞: ${preorderPrice} ‡∏ø\n–ì–æ—Ä–æ–¥: ${position.city}, ${position.district}\n–õ–æ–∫–∞—Ü–∏—è: ${location || '—Å–ª—É—á–∞–π–Ω–∞—è'}`);
                addMailMessage(`–í–∞—à –ø—Ä–µ–¥–∑–∞–∫–∞–∑ –Ω–∞ ${product.name} (${position.weight} ${unit}) –ø—Ä–∏–Ω—è—Ç. –û–∂–∏–¥–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.`);
                modal.onclick = (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                        updateProfile();
                    }
                };
            });
        }

        function showDepositModal(crypto) {
            const modal = document.getElementById('depositModal');
            const content = document.getElementById('depositContent');
            content.innerHTML = `
                <h2>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ ${crypto}</h2>
                <p>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: ${MIN_DEPOSIT} ‡∏ø</p>
                <input type="number" id="depositAmount" placeholder="–°—É–º–º–∞ –≤ ‡∏ø (–º–∏–Ω. ${MIN_DEPOSIT})" min="${MIN_DEPOSIT}">
                <select id="cryptoSelect">
                    <option value="BTC">Bitcoin (BTC)</option>
                    <option value="ETH">Ethereum (ETH)</option>
                    <option value="USDT">Tether (USDT)</option>
                    <option value="SOL">Solana (SOL)</option>
                    <option value="TON">Toncoin (TON)</option>
                </select>
                <button class="buy-button" onclick="generatePaymentAddress()">–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</button>
                <button class="buy-button" onclick="document.getElementById('depositModal').style.display='none';">–ó–∞–∫—Ä—ã—Ç—å</button>
                <p id="paymentDetails" style="display: none; word-break: break-all;"></p>
            `;
            modal.style.display = 'flex';
            modal.onclick = (e) => {
                if (e.target === modal) modal.style.display = 'none';
            };
        }

        function generatePaymentAddress() {
            const amount = parseInt(document.getElementById('depositAmount').value);
            const crypto = document.getElementById('cryptoSelect').value;
            if (!amount || amount < MIN_DEPOSIT) {
                alert(`–°—É–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ ${MIN_DEPOSIT} ‡∏ø!`);
                return;
            }
            const address = generateUniqueAddress(crypto);
            const cryptoAmount = (amount / BTC_RATE).toFixed(5);
            const paymentId = `${currentUser}_${Date.now()}`;
            pendingPayments[paymentId] = { user: currentUser, amount, crypto };
            const paymentDetails = document.getElementById('paymentDetails');
            paymentDetails.innerHTML = `
                <p>–ê–¥—Ä–µ—Å –¥–ª—è –æ–ø–ª–∞—Ç—ã (${crypto}): ${address}</p>
                <p>–°—É–º–º–∞: ${amount} ‡∏ø (~${cryptoAmount} ${crypto})</p>
                <p>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: 30 –º–∏–Ω—É—Ç</p>
                <p>–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —É–≤–µ–¥–æ–º–∏—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ Telegram —Å —É–∫–∞–∑–∞–Ω–∏–µ–º ID: ${paymentId}</p>
            `;
            paymentDetails.style.display = 'block';
            sendToTelegramBot(`üí∏ –ù–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ:\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${currentUser}\n–ö—Ä–∏–ø—Ç–∞: ${crypto}\n–ê–¥—Ä–µ—Å: ${address}\n–°—É–º–º–∞: ${amount} ‡∏ø (~${cryptoAmount} ${crypto})\nID: ${paymentId}`, paymentId, amount);
            setTimeout(() => {
                if (pendingPayments[paymentId]) {
                    delete pendingPayments[paymentId];
                    paymentDetails.innerHTML = '<p>–ê–¥—Ä–µ—Å –∏—Å—Ç—ë–∫! –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π.</p>';
                }
            }, 30 * 60 * 1000);
        }

        function checkPendingPayment(paymentId, amount) {
            if (pendingPayments[paymentId]) {
                balance += amount;
                referralDeposits += amount;
                delete pendingPayments[paymentId];
                updateProfile();
                addMailMessage(`üí∞ –ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} ‡∏ø`);
                if (window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.showAlert(`–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} ‡∏ø!`);
                } else {
                    alert(`–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} ‡∏ø!`);
                }
            }
        }

        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.onEvent('web_app_data', (event) => {
                const data = event.data;
                if (data && typeof data === 'string') {
                    if (data.startsWith('PaymentConfirmed')) {
                        const [_, user, amount] = data.split(':');
                                        if (user === window.Telegram.WebApp.initDataUnsafe.user?.id.toString()) {
                    const paymentId = Object.keys(pendingPayments).find(id => pendingPayments[id].user === currentUser);
                    if (paymentId) checkPendingPayment(paymentId, parseInt(amount));
                }
            } else if (data.startsWith('PaymentRejected')) {
                const [_, user] = data.split(':');
                if (user === window.Telegram.WebApp.initDataUnsafe.user?.id.toString()) {
                    const paymentId = Object.keys(pendingPayments).find(id => pendingPayments[id].user === currentUser);
                    if (paymentId) {
                        delete pendingPayments[paymentId];
                        window.Telegram.WebApp.showAlert('–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω—ë–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.');
                        addMailMessage('–í–∞—à –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—ã–ª –æ—Ç–∫–ª–æ–Ω—ë–Ω.');
                    }
                }
            }
        }
    });
}

function checkReferralBonus() {
    if (referralCount >= 25 && !orderHistory.some(o => o.product.includes('Bolivian Fishscale'))) {
        orderHistory.unshift({ date: getRandomDate(), product: "–ë–æ–Ω—É—Å: Bolivian Fishscale (VHQ) 1 –≥", price: 0 });
        addMailMessage('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ó–∞ 25 –¥—Ä—É–∑–µ–π –≤—ã –ø–æ–ª—É—á–∏–ª–∏ 1 –≥ Bolivian Fishscale (VHQ)!');
    } else if (referralCount >= 10 && !orderHistory.some(o => o.product.includes('Peruvian Dust'))) {
        orderHistory.unshift({ date: getRandomDate(), product: "–ë–æ–Ω—É—Å: Peruvian Dust (MQ) 0.5 –≥", price: 0 });
        addMailMessage('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ó–∞ 10 –¥—Ä—É–∑–µ–π –≤—ã –ø–æ–ª—É—á–∏–ª–∏ 0.5 –≥ Peruvian Dust (MQ)!');
    } else if (referralCount >= 5 && !orderHistory.some(o => o.product.includes('Crystal Surge'))) {
        orderHistory.unshift({ date: getRandomDate(), product: "–ë–æ–Ω—É—Å: Crystal Surge (VHQ) 0.5 –≥", price: 0 });
        addMailMessage('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ó–∞ 5 –¥—Ä—É–∑–µ–π –≤—ã –ø–æ–ª—É—á–∏–ª–∏ 0.5 –≥ Crystal Surge (VHQ)!');
    }
    if (referralDeposits >= 10000 && referralCount >= 3) {
        balance += 500;
        referralDeposits = 0;
        addMailMessage('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø–æ–ª—É—á–∏–ª–∏ –±–æ–Ω—É—Å 500 ‡∏ø –∑–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ 3+ –¥—Ä—É–∑–µ–π –∏ –∏—Ö –¥–µ–ø–æ–∑–∏—Ç—ã –Ω–∞ 10,000+ ‡∏ø!');
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.showAlert('–ë–æ–Ω—É—Å 500 ‡∏ø –∑–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –Ω–∞—á–∏—Å–ª–µ–Ω!');
        } else {
            alert('–ë–æ–Ω—É—Å 500 ‡∏ø –∑–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –Ω–∞—á–∏—Å–ª–µ–Ω!');
        }
    }
}

function applyForJob(job) {
    showCustomTextareaPrompt(`–û—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é "${job}". –£–∫–∞–∂–∏—Ç–µ –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ:`, (resume) => {
        if (resume) {
            sendToTelegramBot(`üìã –ó–∞—è–≤–∫–∞ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é "${job}" –æ—Ç ${currentUser}:\n–†–µ–∑—é–º–µ: ${resume}`);
            addMailMessage(`–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é "${job}" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –û–∂–∏–¥–∞–π—Ç–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏.`);
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.showAlert(`–ó–∞—è–≤–∫–∞ –Ω–∞ "${job}" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!`);
            } else {
                alert(`–ó–∞—è–≤–∫–∞ –Ω–∞ "${job}" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!`);
            }
        }
    });
}

function showCustomConfirm(message, onYes, onNo) {
    const modal = document.getElementById('customModal');
    const content = document.getElementById('customContent');
    content.innerHTML = `
        <h2>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h2>
        <p>${message}</p>
        <button class="buy-button" id="confirmYes">–î–∞</button>
        <button class="buy-button" id="confirmNo">–ù–µ—Ç</button>
    `;
    modal.style.display = 'flex';
    document.getElementById('confirmYes').onclick = () => { onYes(); modal.style.display = 'none'; };
    document.getElementById('confirmNo').onclick = () => { onNo(); modal.style.display = 'none'; };
    modal.onclick = (e) => { if (e.target === modal) modal.style.display = 'none'; };
}

function showCustomPrompt(message, onConfirm) {
    const modal = document.getElementById('customModal');
    const content = document.getElementById('customContent');
    content.innerHTML = `
        <h2>–í–≤–æ–¥</h2>
        <p>${message}</p>
        <input type="text" id="customInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ">
        <button class="buy-button" id="promptConfirm">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        <button class="buy-button" id="promptCancel">–û—Ç–º–µ–Ω–∞</button>
    `;
    modal.style.display = 'flex';
    document.getElementById('promptConfirm').onclick = () => {
        onConfirm(document.getElementById('customInput').value);
        modal.style.display = 'none';
    };
    document.getElementById('promptCancel').onclick = () => {
        onConfirm(null);
        modal.style.display = 'none';
    };
    modal.onclick = (e) => { if (e.target === modal) modal.style.display = 'none'; };
}

function showCustomTextareaPrompt(message, onConfirm) {
    const modal = document.getElementById('customModal');
    const content = document.getElementById('customContent');
    content.innerHTML = `
        <h2>–í–≤–æ–¥</h2>
        <p>${message}</p>
        <textarea id="customTextarea" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ"></textarea>
        <button class="buy-button" id="promptConfirm">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        <button class="buy-button" id="promptCancel">–û—Ç–º–µ–Ω–∞</button>
    `;
    modal.style.display = 'flex';
    document.getElementById('promptConfirm').onclick = () => {
        onConfirm(document.getElementById('customTextarea').value);
        modal.style.display = 'none';
    };
    document.getElementById('promptCancel').onclick = () => {
        onConfirm(null);
        modal.style.display = 'none';
    };
    modal.onclick = (e) => { if (e.target === modal) modal.style.display = 'none'; };
}

document.getElementById('referralLink').addEventListener('click', () => {
    referralCount++;
    updateProfile();
});

    </script>
</body>
</html>
